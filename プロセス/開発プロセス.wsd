@startuml
skinparam note {
    BackgroundColor #LightYellow
    BorderColor #Black
}

[*] --> システム目標定義
note right of システム目標定義
  **目的**: プロジェクトの方向性とゴールを定義。
  **トレードオフ**: 省略不可。これがなければ開発は開始できない。
end note

システム目標定義 --> 安全制約導出
note left of 安全制約導出
  **目的**: STPAなどの手法でシステムの安全性を確保する制約を導出。
  **トレードオフ**:
  - **Gain**: 期間短縮、コスト削減。
  - **Loss**: 安全性の担保が不十分になり、人命や資産に関わるリスクが増大。
  **判断基準**: 安全非機能要求が低いシステムでのみ簡略化を検討。
end note

安全制約導出 --> 要求図
システム目標定義 --> 要求図
note right of 要求図
  **目的**: システムが満たすべき機能・非機能要件を定義。
  **トレードオフ**: 省略不可。要件がなければ何を開発するかが不明確になる。
end note

要求図 --> コンテキスト図
note on link
  **目的**: システムと外部要素との境界、I/Fを明確化。
  **トレードオフ**:
  - **Gain**: 作図コスト削減。
  - **Loss**: 外部連携の考慮漏れリスク増大。
  **判断基準**: 外部I/Fが皆無か自明な場合のみ検討。
end note

コンテキスト図 --> ユースケース図
要求図 --> ユースケース図
ユースケース図 --> ユースケース記述
note on link
  **目的**: 利用者視点でのシステムの振る舞いを定義。
  **トレードオフ**: 省略不可。ユースケース駆動開発の中核。
end note

ユースケース記述 --> アクティビティ図_ユースケース
note right of アクティビティ図_ユースケース
  **目的**: ユースケースの流れ（特に分岐や並行処理）を可視化し、曖昧さを排除。
  **トレードオフ**:
  - **Gain**: 作図コスト削減。
  - **Loss**: テキストのみでは解釈が分かれ、実装時の手戻りリスク増大。
  **判断基準**: 振る舞いが非常にシンプルな場合のみ検討。
end note

アクティビティ図_ユースケース --> ステートマシン図
note right of ステートマシン図
  **目的**: システムの全体状態と遷移を定義。
  **トレードオフ**: 省略不可。状態を持つシステム（例:自動販売機）では、これがないと振る舞いの整合性が保証できない。
end note

アクティビティ図_ユースケース --> システム構成図
note left of システム構成図
  **目的**: H/W、S/Wの物理的/論理的な構造（アーキテクチャ）を定義。
  **トレードオフ**: 省略不可。システムの構成要素を定義する根幹。
end note


システム構成図 --> FMEA分析
ステートマシン図 --> FMEA分析
FMEA分析 --> FTA分析
note on link
  **目的**: 故障モードやハザードを網羅的に分析し、信頼性・安全性を向上。
  **トレードオフ**:
  - **Gain**: 期間短縮、分析コスト削減。
  - **Loss**: 潜在リスクの見逃し、市場不具合のリスク増大。
  **判断基準**: 安全・信頼性要求が低いシステムでのみ簡略化を検討。
end note

FTA分析 -[#blue,dashed]-> システム構成図 : 改善フィードバック
FTA分析 -[#blue,dashed]-> ステートマシン図 : 改善フィードバック

ステートマシン図 --> アクティビティ図_機能
システム構成図 --> アクティビティ図_機能
note right of アクティビティ図_機能
  **目的**: コンポーネント内の詳細な処理ロジックを定義。
  **トレードオフ**:
  - **Gain**: 作図コスト削減。
  - **Loss**: 実装者への情報が不足し、設計意図と異なる実装になるリスク。
  **判断基準**: ユースケースレベルの図で実装可能なほど詳細な場合、集約を検討。
end note

アクティビティ図_機能 --> 安全設計フィードバック
安全設計フィードバック -[#blue,dashed]-> 要求図 : 改善フィードバック
安全設計フィードバック --> シーケンス図_機能
note on link
  **目的**: コンポーネント間の動的な相互作用（メッセージの時系列）を検証。
  **トレードオフ**:
  - **Gain**: 作図コスト削減。
  - **Loss**: 複雑な連携処理の設計不備を見逃すリスク。
  **判断基準**: コンポーネント間の連携がシンプルな場合のみ検討。
end note

シーケンス図_機能 --> [*]

@enduml